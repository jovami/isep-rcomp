module Main where

import Data.Foldable (for_)
import GHC.Float (ceilingFloat)
import Text.Printf (printf)

type Distance = Float
type Scale = Float

data Section = Section String Scale [Distance]

totalDist :: Section -> Distance
totalDist (Section _ scale dists)= foldl (\b -> (b+) . (scale *)) 0.0 dists

instance Show Section
    where show s@(Section str _ _) = printf "Section \"%s\" cable length: %.2f m" str $ totalDist s


secs :: [Section]
secs =
    [ Section "Floor 0 copper" (5 / 292)
        [   -- Counter clockwise outlets
            -- 1m => 58.4 px

            -------A.0.1-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323,

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 145,

            --- bottom
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 145, 137, 99,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85,
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85, 134,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85, 134, 221,

            -------A.0.2-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32, 157, 32

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 58.4, 68,
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 58.4, 68, 138,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 58.4, 76,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 58.4, 142,

            -------A.0.3-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32,

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 58.4, 107,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 150,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46,
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120,

            --- bottom
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120, 122, 50,

            --- AP
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120, 122, 50, 67, 35, 175.2,

            -------A.0.4-------
            --- top
            26, 133, 105,
            26, 133, 105, 85,

            --- left
            26, 133, 105, 85, 84, 80,
            26, 133, 105, 85, 84, 80, 120,

            --- right
            26, 58.4, 280, 58.4, 55,
            26, 58.4, 280, 58.4, 55, 113,
            --- bottom
            26, 58.4, 280, 58.4, 140,

            -------A.0.5-------
            -- pfx
            -- 26, 58.4, 280, 35,

            --- top
            26, 58.4, 280, 35, 58.4, 134,
            26, 58.4, 280, 35, 58.4, 134, 152,

            --- right
            26, 58.4, 280, 35, 58.4, 124,

            --- bottom
            26, 58.4, 280, 35, 124, 121, 58.4, 66,
            26, 58.4, 280, 35, 124, 121, 58.4, 66, 132,

            -------A.0.6-------
            -- pfx
            -- 26, 58.4, 280, 35, 124, 121, 35,

            --- top
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 174,

            --- right
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66,
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66, 147,
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66, 147, 117,

            --- bottom
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124,
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114,

            --- left
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114, 183,
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114, 183, 112
        ]
    , Section "Floor 0 fiber" (5 / 292)
        [
            --- Incoming
            22, 43, 233.6,

            --- Outgoing
            233.6, 60, 22,
            233.6, 60, 22
        ]
    , Section "Floor 1 copper" (5 / 292)
        [

        ]
    , Section "Floor 1 fiber" (5 / 292)
        [
            -- 58.4 => 1 meter

            --- Incoming
            58.4, 28,

            --- Outgoing
            28, 58.4,
            28, 58.4
        ]
    , Section "Outside fiber" (20 / 174)
        [
            -- Into building A
            353, 196, 22,

            -- Outgoing fiber from A
            22, 22,

            -- Fiber cables in a ring for redundancy
            662, 686, 1554,
            662, 686, 1554,

            -- Incoming fiber for the remaining buildings
            22, 22, 22, 22,
            22, 22, 22, 22
        ]
    ]


main :: IO ()
main = for_ secs print
