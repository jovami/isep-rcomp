module Cables where

import Data.Foldable (for_)
import GHC.Float (ceilingFloat)
import Text.Printf (printf)

type Distance = Float
type Scale = Float

data Section = Section String Scale [Distance]

totalDist :: Section -> Distance
totalDist (Section _ scale dists) = foldl (\b -> (b+) . (scale *)) 0.0 dists

instance Show Section
    where show s@(Section str _ _) = printf "Section \"%s\" cable length: %.2f m" str $ totalDist s


secs :: [Section]
secs =
    [ Section "Floor 0 copper" (5 / 292)
    -- {{{
        [   -- Counter clockwise outlets
            -- 1m => 58.4 px

            -------A.0.1-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323,

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 145,

            --- bottom
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 145, 137, 99,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85,
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85, 134,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 323, 58.4, 85, 134, 221,

            -------A.0.2-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32, 157, 32

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 58.4, 68,
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 193, 58.4, 68, 138,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 58.4, 76,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 157, 32, 58.4, 142,

            -------A.0.3-------
            -- pfx
            -- 26, 133, 105, 85, 84, 58.4, 32,

            --- left
            26, 133, 105, 85, 84, 58.4, 32, 157, 58.4, 107,

            --- top
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 150,

            --- right
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46,
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120,

            --- bottom
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120, 122, 50,

            --- AP
            26, 133, 105, 85, 84, 58.4, 32, 58.4, 46, 120, 122, 50, 67, 35, 175.2,

            -------A.0.4-------
            --- top
            26, 133, 105,
            26, 133, 105, 85,

            --- left
            26, 133, 105, 85, 84, 80,
            26, 133, 105, 85, 84, 80, 120,

            --- right
            26, 58.4, 280, 58.4, 55,
            26, 58.4, 280, 58.4, 55, 113,
            --- bottom
            26, 58.4, 280, 58.4, 140,

            --- MC=>IC connection (4 copper cables)
            (4*) $ sum [ 26, 233.6, 28 ],

            -------A.0.5-------
            -- pfx
            -- 26, 58.4, 280, 35,

            --- top
            26, 58.4, 280, 35, 58.4, 134,
            26, 58.4, 280, 35, 58.4, 134, 152,

            --- right
            26, 58.4, 280, 35, 58.4, 124,

            --- bottom
            26, 58.4, 280, 35, 124, 121, 58.4, 66,
            26, 58.4, 280, 35, 124, 121, 58.4, 66, 132,

            -------A.0.6-------
            -- pfx
            -- 26, 58.4, 280, 35, 124, 121, 35,

            --- top
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 174,

            --- right
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66,
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66, 147,
            26, 58.4, 280, 35, 124, 121, 35, 58.4, 66, 147, 117,

            --- bottom
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124,
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114,

            --- left
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114, 183,
            26, 58.4, 280, 35, 124, 121, 35, 66, 147, 117, 92, 58.4, 124, 114, 183, 112
        ]
    -- }}}
    , Section "Floor 0 fiber" (5 / 292)
        [
            --- Incoming
            22, 43, 233.6,

            --- Outgoing
            233.6, 60, 22
            --, 233.6, 60, 22
        ]
    , Section "Floor 1 copper" (5 / 292)
    -- F1 copper {{{
        [
            ---A.1.7---
            -- pfx
            -- 28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546,

            --- top
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 102.2, 61,
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 102.2, 61, 112,
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 102.2, 61, 112, 108,

            --- left
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 260, 102.2, 126,

            --- bottom
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 260, 102.2, 58,
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 546, 260, 102.2, 58, 122,

            ---A.1.1---

            --- left
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 102.2, 20,
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 102.2, 20, 160,
            28, 76, 102.2, 26, 457, 227, 226, 116, 210, 102.2, 20, 160, 153,

            --- right
            28, 76, 102.2, 26, 457, 227, 226, 102.2, 116,
            28, 76, 102.2, 26, 457, 227, 226, 102.2, 116, 146,

            ---A.1.2---

            --- top
            28, 76, 102.2, 26, 457, 227, 102.2, 108,

            --- left
            --- 226 = 108 + 118
            28, 76, 102.2, 26, 457, 227, 226, 102.2, 116,
            28, 76, 102.2, 26, 457, 227, 226, 102.2, 116, 146,

            --- right
            28, 76, 102.2, 26, 457, 227, 102.2, 124,
            28, 76, 102.2, 26, 457, 227, 102.2, 124, 156,

            ---A.1.3---
            --
            --- top
            28, 76, 102.2, 26, 457, 102.2, 106,

            --- left
            --- 227 = 106 + 121
            28, 76, 102.2, 26, 457, 227, 102.2, 124,
            28, 76, 102.2, 26, 457, 227, 102.2, 124, 156,

            --- right
            28, 76, 102.2, 26, 457, 102.2, 106, 23,
            28, 76, 102.2, 26, 457, 102.2, 106, 23, 74, 78,

            -- 58.4 => 1 meter
            -- 102.2 => 1.75 meters

            -- 28, 102.2,

            ---A.1.4---
            --- top
            28, 102, 132,
            28, 102, 132, 124,
            28, 102, 132, 124, 121,

            --- left
            --- 457 = sum [132, 124, 121, 80]
            28, 76, 102.2, 26, 457, 102.2, 106,
            28, 76, 102.2, 26, 457, 102.2, 106, 23, 74,
            28, 76, 102.2, 26, 457, 102.2, 106, 23, 74, 78, 23,

            --- AP
            28, 76, 102.2, 26, 457, 102.2, 106, 23, 74, 78, 23, 138,

            --- right
            28, 86,
            28, 86, 100,

            --- bottom
            -- 28, 102.2, 317, 102.2,
            28, 102.2, 317, 102.2, 60,
            28, 102.2, 317, 102.2, 60, 56, 38,
            28, 102.2, 317, 102.2, 60, 56, 38, 106, --

            ---A.1.5---
            --
            --- top
            28, 102.2, 317, 102.2, 60, 56,
            28, 102.2, 317, 102.2, 60, 56, 38, 106, --

            --- right
            28, 102.2, 317, 102.2, 132,

            --- bottom
            28, 102.2, 317, 132, 150, 102.2, 66,
            28, 102.2, 317, 132, 150, 102.2, 66, 128,

            ---A.1.6---
            --
            --- top
            28, 102.2, 317, 132, 150, 102.2, 66,
            28, 102.2, 317, 132, 150, 102.2, 66, 128,

            --- left
            -- 418 + 324 => ↓⊕ ←
            -- 28, 102.2, 317, 132, 150, 418, 324, 102.2,

            28, 102.2, 317, 132, 150, 418, 324, 102.2, 74,
            28, 102.2, 317, 132, 150, 418, 324, 102.2, 74, 137,

            --- right
            28, 102.2, 317, 132, 150, 102.2, 160,
            28, 102.2, 317, 132, 150, 102.2, 160, 138,

            --- bottom
            -- 418 + 324 => ↓⊕ ←
            -- 28, 102.2, 317, 132, 150, 418, 324, 102.2,

            28, 102.2, 317, 132, 150, 418, 324, 102.2, 122,
            28, 102.2, 317, 132, 150, 418, 324, 102.2, 122, 136
        ]
    -- }}}
    , Section "Floor 1 fiber" (5 / 292)
        [
            -- 58.4 => 1 meter

            --- Incoming
            58.4, 28,

            --- Outgoing
            28, 58.4
            -- , 28, 58.4
        ]
    , Section "Outside fiber" (20 / 174)
        [
            -- Into building A
            353, 196, 22,

            -- Outgoing fiber from A
            22,

            -- Fiber cables
            662, 686, 1554, 1554,
            -- 662, 686, 1554, 1554,

            -- Incoming fiber for the remaining buildings
            22, 22, 22, 22
            -- , 22, 22, 22, 22
        ]
    ]


raceway0 :: [Distance]
raceway0 =
    [
        ---A.0.1---
        --- left
        145, 137,
        --- bottom
        99,
        --- top
        58.4, 85, 134,
        --- right
        221,

        ---A.0.2---
        --- left
        58.4, 68, 138,
        --- top
        76,
        --- right
        58.4, 142,

        ---A.0.3---
        --- left
        58.4, 107,
        --- top
        58.4, 150,
        --- right
        46, 120, 122,
        --- bottom + AP
        50, 67, 35, 175.2,

        ---A.0.4---
        --- top
        105, 85, 84,
        --- left
        58.4, 80, 120,
        --- right
        58.4, 26, 133, 55, 113,
        --- bottom
        140,

        --- MC => IC connection
        233.6,

        ---A.0.5---
        --- top
        58.4, 134, 152,
        --- right
        124,
        --- bottom
        58.4, 66, 132,

        ---A.0.6---
        --- top
        58.4, 174,
        --- right
        66, 147, 117,
        --- bottom
        58.4, 124, 114,
        --- left
        183, 112
    ]
raceway1 :: [Distance]
raceway1 =
    [
        ---A.1.7---
        --- top
        102.2, 61, 112, 108,
        --- left
        102.2, 126,
        --- bottom
        58, 122,

        ---A.1.1---
        --- left
        102.2, 20, 160, 153,

        ---A.1.2---
        --- top
        108,
        --- left
        102.2, 116, 146,


        ---A.1.3---
        --- top
        106,
        --- left
        102.2, 124, 156,


        ---A.1.4---
        --- top
        132, 124, 121,
        --- left
        102.2, 106, 23, 74, 78, 23, 138,
        --- right
        28, 102, 102.2,
        --- bottom
        102.2, 60, 56, 38, 106,

        ---A.1.5---
        --- right
        132,
        --- bottom
        102.2, 66, 128,

        ---A.1.6---
        --- right
        160, 138,
        --- bottom
        102.2, 122, 136,
        --- left
        74, 137
    ]

main :: IO ()
main = do
    for_ secs print

    printf "\nRaceway for floor 0: %.2f m\n" $ total raceway0
    printf "Raceway for floor 1: %.2f m\n" $ total raceway1
    where
        scale = 5 / 292
        total :: [Distance] -> Distance
        total = foldl (\b -> (b+) . (scale *)) 0.0
